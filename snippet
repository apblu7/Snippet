import com.google.common.cache.Cache;
import com.google.common.cache.CacheBuilder;

import java.util.concurrent.TimeUnit;

public class RetryContextHolder {

    private static final Cache<Long, Integer> retryCountCache =
            CacheBuilder.newBuilder()
                    .expireAfterWrite(10, TimeUnit.MINUTES)
                    .build();

    // 현재 스레드 기준으로 저장
    public static void setRetryCountForCurrentThread(int count) {
        retryCountCache.put(Thread.currentThread().getId(), count);
    }

    // 현재 스레드 기준으로 조회
    public static Integer getRetryCountForCurrentThread() {
        return retryCountCache.getIfPresent(Thread.currentThread().getId());
    }
}