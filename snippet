@echo off
set "SERVER=ubuntu@10.110.30.50"
set "WAR_FILE=ets.war"
set "REMOTE_DIR=/home/ubuntu"
set "PPK_PATH=server_key.ppk"

echo [Step 1] Copying WAR file to remote server...
pscp -i "%PPK_PATH%" "%WAR_FILE%" %SERVER%:"%REMOTE_DIR%/"

if %errorlevel% neq 0 (
    echo [Error] Failed to copy WAR file to remote server.
    exit /b 1
)

echo [Step 2] Verifying uploaded file...
plink -i "%PPK_PATH%" %SERVER% "ls -lh '%REMOTE_DIR%/%WAR_FILE%'"

if %errorlevel% neq 0 (
    echo [Error] Failed to verify WAR file on remote server.
    exit /b 1
)

echo [Success] WAR file has been copied and verified.