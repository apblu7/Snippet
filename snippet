import java.util.Map;
import java.util.HashMap;
import org.springframework.http.*;
import org.springframework.web.client.RestTemplate;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.dataformat.xml.XmlMapper;

public class RestClient {
    private static final RestTemplate restTemplate = new RestTemplate();
    private static final ObjectMapper jsonMapper = new ObjectMapper();
    private static final XmlMapper xmlMapper = new XmlMapper();

    public static Map<String, Object> callApi(String url) throws Exception {
        ResponseEntity<String> response = restTemplate.exchange(url, HttpMethod.GET, null, String.class);
        HttpHeaders headers = response.getHeaders();
        String contentType = headers.getContentType() != null ? headers.getContentType().toString() : "";

        if (contentType.contains("xml")) {
            return xmlToJson(response.getBody());
        } else {
            return jsonMapper.readValue(response.getBody(), Map.class);
        }
    }

    private static Map<String, Object> xmlToJson(String xml) throws Exception {
        return jsonMapper.convertValue(xmlMapper.readTree(xml), Map.class);
    }

    public static void main(String[] args) throws Exception {
        String url = "https://example.com/api";
        Map<String, Object> result = callApi(url);
        System.out.println(result);
    }
}