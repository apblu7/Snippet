package com.example.demo;

import org.springframework.core.io.ClassPathResource;
import org.springframework.core.io.Resource;
import org.springframework.web.bind.annotation.*;

import java.io.IOException;
import java.nio.charset.StandardCharsets;

@RestController
@RequestMapping("/json")
public class JsonController {

    private final String originalJson;
    private String updatedJson = null;

    public JsonController() throws IOException {
        Resource resource = new ClassPathResource("data/sample.json");
        this.originalJson = new String(resource.getInputStream().readAllBytes(), StandardCharsets.UTF_8);
    }

    // 현재 JSON 반환
    @GetMapping
    public String getJson() {
        return updatedJson != null ? updatedJson : originalJson;
    }

    // 새로운 JSON으로 업데이트
    @PostMapping
    public String updateJson(@RequestBody String newJson) {
        this.updatedJson = newJson;
        return "updated";
    }

    // 초기 상태로 되돌리기
    @PostMapping("/reset")
    public String resetJson() {
        this.updatedJson = null;
        return "reset";
    }
}