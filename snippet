// 1. 외부에서 받은 JsonNode (실제로는 ArrayNode)
JsonNode jsonNode = restTemplate.getForObject(url, JsonNode.class);

// 2. JsonNode -> List<Map<String, Object>>
List<Map<String, Object>> list = flattenJsonNode(jsonNode);

// 3. Map처럼 그룹핑
Map<String, List<Map<String, Object>>> grouped = list.stream()
    .collect(Collectors.groupingBy(m -> {
        String k1 = String.valueOf(m.getOrDefault("key1", ""));
        String k2 = String.valueOf(m.getOrDefault("key2", ""));
        return k1 + "_" + k2;
    }));

// 4. 다시 JSON 문자열로 만들기
for (List<Map<String, Object>> group : grouped.values()) {
    String json = mapper.writeValueAsString(group);
    updateJsonInDatabase(json);
}