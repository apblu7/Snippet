# 베이스 이미지 선택 (예: Ubuntu)
FROM ubuntu:20.04

# 쉘 스크립트와 설치 파일 복사
COPY iptables-offline.deb /home/def/iptables-offline.deb
COPY start.sh /home/def/start.sh

# 필요한 권한 부여
RUN chmod +x /home/def/start.sh

# 필수 도구 설치 (기본적으로 dpkg 등은 있음, 없으면 coreutils 등도 설치)
RUN apt-get update && apt-get install -y netbase iproute2 iputils-ping

# 오프라인이라면 여기에 필요한 패키지들도 미리 복사해놓고 설치
# 예: RUN dpkg -i /path/to/package.deb

# Tomcat 및 JDK는 미리 옮겨놓고 아래처럼 압축 해제
COPY jdk1.7.0_12 /opt/jdk1.7.0_12
COPY apache-tomcat-6.0.18 /opt/apache-tomcat-6.0.18

# 환경 변수 설정
ENV JAVA_HOME=/opt/jdk1.7.0_12
ENV CATALINA_HOME=/opt/apache-tomcat-6.0.18
ENV PATH=$JAVA_HOME/bin:$PATH

# 컨테이너 시작 시 실행될 명령
CMD ["/home/def/start.sh"]